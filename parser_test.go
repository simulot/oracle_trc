package main

import (
	"reflect"
	"strings"
	"testing"
)

func Test_parser_NextPacket(t *testing.T) {
	tests := []struct {
		name string
		p    *parser
		want *Packet
	}{
		{
			name: "select",
			p: New(strings.NewReader(
				`
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: packet dump
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 00 C3 00 00 06 00 00 00  |........|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 00 00 11 69 0D 01 01 01  |...i....|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 01 01 03 5E 0E 02 80 61  |...^...a|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 00 01 02 01 6B 01 01 0D  |....k...|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 01 01 00 01 64 00 00 00  |....d...|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 00 01 00 01 01 01 00 00  |........|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 01 01 00 00 00 00 00 FE  |........|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 40 73 65 6C 65 63 74 20  |@select.|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 43 4F 55 4E 54 28 2A 29  |COUNT(*)|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 20 66 72 6F 6D 20 75 73  |.from.us|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 65 72 5F 74 61 62 5F 63  |er_tab_c|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 6F 6C 75 6D 6E 73 20 77  |olumns.w|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 68 65 72 65 20 74 61 62  |here.tab|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 6C 65 5F 6E 61 6D 65 20  |le_name.|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 3D 20 4E 27 42 57 5F 55  |=.N'BW_U|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 53 39 45 52 5F 41 55 54  |S9ER_AUT|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 48 45 4E 54 49 43 41 54  |HENTICAT|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 49 4F 4E 27 20 61 6E 64  |ION'.and|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 20 63 6F 6C 75 6D 6E 5F  |.column_|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 6E 61 6D 65 20 3D 20 4E  |name.=.N|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 27 55 41 55 5F 46 4F 52  |'UAU_FOR|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 47 4F 54 5F 41 43 54 49  |GOT_ACTI|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 4F 4E 27 00 01 01 00 00  |ON'.....|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 00 00 00 00 01 01 00 00  |........|
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: 00 00 00                 |...     |
(6604) [12-FEB-2019 16:40:00:651] nsbasic_bsd: exit (0)
(6604) [12-FEB-2019 16:40:00:651] nsbasic_brc: entry: oln/tot=0
(6604) [12-FEB-2019 16:40:00:651] nttfprd: entry
(6604) [12-FEB-2019 16:40:00:651] nttfprd: socket 836 had bytes read=183
(6604) [12-FEB-2019 16:40:00:651] nttfprd: exit
`), "test"),
			want: nil,
		},
		{
			name: "select",
			p: New(strings.NewReader(
				`
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: packet dump
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 01 4F 00 00 06 00 00 00  |.O......|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 00 00 11 69 11 01 01 01  |...i....|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 01 01 03 5E 12 02 81 29  |...^...)|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 00 01 02 01 C5 01 01 0D  |........|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 01 01 00 01 01 00 01 01  |........|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 04 00 01 00 01 01 01 00  |........|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 00 01 01 00 00 00 00 00  |........|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: FE 40 49 4E 53 45 52 54  |.@INSERT|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 20 49 4E 54 4F 20 42 57  |.INTO.BW|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 5F 55 53 45 52 5F 41 55  |_USER_AU|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 54 48 5F 4C 4F 47 20 28  |TH_LOG.(|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 55 41 4C 5F 49 44 2C 55  |UAL_ID,U|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 41 4C 5F 55 53 45 52 5F  |AL_USER_|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 4E 45 54 57 4F 52 4B 5F  |NETWORK_|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 4E 41 4D 45 2C 55 41 4C  |NAME,UAL|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 5F 4C 40 4F 47 5F 43 4F  |_L@OG_CO|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 44 45 2C 55 41 4C 5F 53  |DE,UAL_S|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 54 41 4D 50 5F 44 41 54  |TAMP_DAT|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 45 2C 55 41 4C 5F 41 50  |E,UAL_AP|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 50 4C 49 43 41 54 49 4F  |PLICATIO|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 4E 29 20 56 41 4C 55 45  |N).VALUE|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 53 20 28 3A 31 2C 3A 32  |S.(:1,:2|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 2C 3A 33 2C 28 53 45 4C  |,:3,(SEL|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 45 43 54 17 20 53 59 53  |ECT..SYS|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 44 41 54 45 20 46 52 4F  |DATE.FRO|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 4D 20 44 55 41 4C 29 2C  |M.DUAL),|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 3A 34 29 00 01 01 01 01  |:4).....|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 00 00 00 00 00 01 04 00  |........|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 00 00 00 00 60 01 00 00  |....x...|
(9520) [26-FEB-2019 11:52:23:665] nsbasic_bsd: 01 78 00 01 10 00 00 02  |.x......|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 03 69 01 00 60 01 00 00  |.i..s...|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 01 36 00 01 10 00 00 02  |.6......|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 03 69 01 00 02 01 00 00  |.i......|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 01 16 00 00 00 00 00 00  |........|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 00 60 01 00 00 01 3C 00  |.s....<.|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 01 10 00 00 02 03 69 01  |......i.|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 00 07 14 44 38 33 42 36  |...D83B6|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 30 30 36 38 31 39 42 34  |006819B4|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 46 30 33 42 31 45 43 09  |F03B1EC.|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 4A 46 2E 43 41 53 53 41  |JF.CASSA|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 4E 02 C1 02 0A 4D 61 73  |N....Mas|
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: 74 65 72 20 35 2E 31     |ter.5.1 |
(9520) [26-FEB-2019 11:52:23:666] nsbasic_bsd: exit (0)
(9520) [26-FEB-2019 11:52:23:666] nsbasic_brc: entry: oln/tot=0
(9520) [26-FEB-2019 11:52:23:666] nttfprd: entry
`), "test"),
			want: nil,
		},
		{
			name: "select",
			p: New(strings.NewReader(
				`
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: packet dump
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 03 70 00 00 06 00 00 00  |.p......|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 00 00 11 69 08 01 01 01  |...i....|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 01 02 03 5E 09 02 80 69  |...^...i|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 00 01 02 08 B8 01 01 0D  |........|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 01 01 00 01 19 00 01 01  |........|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 01 00 01 00 01 01 01 00  |........|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 00 01 01 00 00 00 00 00  |........|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: FE 40 0D 0A 09 09 09 09  |.@......|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 09 09 73 65 6C 65 63 74  |..select|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 20 63 6F 75 6E 74 28 2A  |.count(*|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 29 20 66 72 6F 6D 20 28  |).from.(|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 0D 0A 09 09 09 09 09 09  |........|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 77 69 74 68 20 44 20 61  |with.D.a|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 73 20 28 0D 0A 09 09 09  |s.(.....|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 09 09 09 09 73 65 6C 65  |....sele|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 63 74 40 20 44 4F 43 5F  |ct@.DOC_|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 49 44 2C 53 54 41 54 55  |ID,STATU|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 53 5F 49 4E 44 45 58 0D  |S_INDEX.|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 0A 09 09 09 09 09 09 09  |........|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 66 72 6F 6D 20 44 4F 43  |from.DOC|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 53 20 77 68 65 72 65 20  |S.where.|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 53 54 41 54 55 53 5F 49  |STATUS_I|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 4E 44 45 58 20 69 6E 20  |NDEX.in.|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 28 32 2C 40 39 39 29 0D  |(2,@99).|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 0A 09 09 09 09 09 09 29  |.......)|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 2C 6C 61 73 74 5F 41 4C  |,last_AL|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 20 61 73 20 28 0D 0A 09  |.as.(...|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 09 09 09 09 09 09 73 65  |......se|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 6C 65 63 74 20 61 6C 2E  |lect.al.|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 64 6F 63 5F 69 64 2C 20  |doc_id,.|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 6D 61 78 28 61 6C 2E 73  |max(al.s|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 74 61 6D 70 40 5F 64 61  |tamp@_da|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 74 65 29 20 73 74 61 6D  |te).stam|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 70 5F 64 61 74 65 0D 0A  |p_date..|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 09 09 09 09 09 09 09 66  |.......f|
(6632) [26-FEB-2019 11:49:09:541] nsbasic_bsd: 72 6F 6D 20 61 63 74 69  |rom.acti|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6F 6E 5F 6C 6F 67 20 61  |on_log.a|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6C 20 6A 6F 69 6E 20 44  |l.join.D|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 20 6F 6E 20 44 2E 44 4F  |.on.D.DO|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 43 5F 49 44 20 40 3D 20  |C_ID.@=.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 61 6C 2E 44 4F 43 5F 49  |al.DOC_I|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 44 0D 0A 09 09 09 09 09  |D.......|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 67 72 6F 75 70 20  |..group.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 62 79 20 61 6C 2E 64 6F  |by.al.do|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 63 5F 69 64 0D 0A 09 09  |c_id....|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 09 09 29 2C 20 0D  |....),..|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 0A 09 09 09 09 09 09 6C  |.......l|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 61 73 74 41 4C 5F 40 55  |astAL_@U|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 49 44 20 61 73 20 28 0D  |ID.as.(.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 0A 09 09 09 09 09 09 09  |........|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 73 65 6C 65 63 74 20 64  |select.d|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 69 73 74 69 6E 63 74 20  |istinct.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 41 4C 2E 64 6F 63 5F 69  |AL.doc_i|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 64 2C 41 4C 2E 73 74 61  |d,AL.sta|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6D 70 5F 75 69 64 20 0D  |mp_uid..|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 0A 09 09 09 09 09 09 40  |.......@|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 66 72 6F 6D 20 44 20  |.from.D.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6A 6F 69 6E 20 6C 61 73  |join.las|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 74 5F 41 4C 20 4C 41 4C  |t_AL.LAL|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 20 6F 6E 20 44 2E 44 4F  |.on.D.DO|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 43 5F 49 44 20 3D 20 4C  |C_ID.=.L|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 41 4C 2E 44 4F 43 5F 49  |AL.DOC_I|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 44 0D 0A 09 09 09 09 09  |D.......|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 6A 6F 69 6E 20 61  |..join.a|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 40 63 74 69 6F 6E 5F 6C  |@ction_l|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6F 67 20 41 4C 20 6F 6E  |og.AL.on|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 20 4C 41 4C 2E 44 4F 43  |.LAL.DOC|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 5F 49 44 20 3D 20 41 4C  |_ID.=.AL|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 2E 44 4F 43 5F 49 44 20  |.DOC_ID.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 61 6E 64 20 4C 41 4C 2E  |and.LAL.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 73 74 61 6D 70 5F 64 61  |stamp_da|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 74 65 20 3D 20 41 4C 2E  |te.=.AL.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 73 40 74 61 6D 70 5F 64  |s@tamp_d|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 61 74 65 0D 0A 09 09 09  |ate.....|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 09 29 0D 0A 09 09  |...)....|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 09 09 73 65 6C 65  |....sele|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 63 74 20 44 2E 44 4F 43  |ct.D.DOC|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 5F 49 44 2C 20 4C 41 4C  |_ID,.LAL|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 2E 53 54 41 4D 50 5F 55  |.STAMP_U|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 49 44 20 66 72 6F 6D 20  |ID.from.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6C 61 40 73 74 41 4C 5F  |la@stAL_|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 55 49 44 20 4C 41 4C 20  |UID.LAL.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6A 6F 69 6E 20 44 20 6F  |join.D.o|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 6E 20 44 2E 44 4F 43 5F  |n.D.DOC_|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 49 44 20 3D 20 4C 41 4C  |ID.=.LAL|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 2E 44 4F 43 5F 49 44 0D  |.DOC_ID.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 0A 09 09 09 09 09 09 77  |.......w|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 68 65 72 65 20 0D 0A 09  |here....|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 09 40 09 09 09 4C  |...@...L|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 41 4C 2E 73 74 61 6D 70  |AL.stamp|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 5F 75 69 64 20 6E 6F 74  |_uid.not|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 20 69 6E 20 28 27 49 4E  |.in.('IN|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 56 4F 49 43 45 20 46 45  |VOICE.FE|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 45 44 42 41 43 4B 27 2C  |EDBACK',|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 20 27 41 55 54 4F 54 52  |.'AUTOTR|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 41 4E 53 46 45 52 27 29  |ANSFER')|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 0D 0A 09 09 28 09 09 09  |....(...|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 61 6E 64 20 44 2E  |..and.D.|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 44 4F 43 5F 49 44 20 3D  |DOC_ID.=|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 20 3A 30 0D 0A 09 09 09  |.:0.....|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 09 29 20 52 0D 0A  |...).R..|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 09 09 09 09 09 00 01 01  |........|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 00 00 00 00 00 00 01 01  |........|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 00 00 00 00 00 01 03 00  |........|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 00 01 80 00 01 10 00 00  |........|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 02 03 69 01 01 20 07 20  |..i.....|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 43 31 35 30 33 36 33 30  |C1503630|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 34 42 33 31 34 44 33 38  |4B314D38|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 39 45 32 32 45 46 41 39  |9E22EFA9|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: 37 34 34 39 44 41 32 36  |7449DA26|
(6632) [26-FEB-2019 11:49:09:542] nsbasic_bsd: exit (0)
(6632) [26-FEB-2019 11:49:09:542] nsbasic_brc: entry: oln/tot=0
				
`), "test"),
			want: nil,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			if got, _ := tt.p.NextPacket(); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("parser.NextPacket() = %#v, want %#v", got, tt.want)
			}
		})
	}
}
